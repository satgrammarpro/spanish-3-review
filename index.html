<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spanish 3 Fun Mastery - Track Your Progress! 🎉</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            padding: 20px;
            background-attachment: fixed;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 25px;
            box-shadow: 0 25px 70px rgba(0,0,0,0.4);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 50%, #48dbfb 100%);
            color: white;
            padding: 50px;
            text-align: center;
            position: relative;
        }

        header h1 {
            font-size: 3em;
            margin-bottom: 15px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .nav-tabs {
            display: flex;
            background: #fff5e6;
            overflow-x: auto;
            border-bottom: 4px solid #ff6b6b;
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 18px 25px;
            cursor: pointer;
            background: #ffe5b4;
            border: none;
            font-size: 16px;
            font-weight: 700;
            color: #333;
            transition: all 0.3s;
            white-space: nowrap;
            border-right: 2px solid #ffd699;
        }

        .nav-tab:hover {
            background: #ffd699;
            transform: translateY(-3px);
        }

        .nav-tab.active {
            background: white;
            color: #ff6b6b;
            border-bottom: 4px solid #ff6b6b;
        }

        .content {
            padding: 40px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: slideIn 0.5s;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .vocab-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .vocab-card {
            background: linear-gradient(135deg, #fff9e6 0%, #ffe6f2 100%);
            border-radius: 15px;
            padding: 25px;
            border-left: 6px solid #ff6b6b;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .vocab-card:hover {
            transform: translateY(-8px) rotate(2deg);
            box-shadow: 0 12px 24px rgba(255, 107, 107, 0.3);
        }

        .vocab-card.mastered {
            border-left-color: #20bf6b;
            background: linear-gradient(135deg, #d4edda 0%, #c3f9d5 100%);
            animation: celebration 0.5s;
        }

        @keyframes celebration {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .vocab-card .spanish {
            font-size: 1.5em;
            font-weight: 800;
            color: #ff6b6b;
            margin-bottom: 12px;
        }

        .vocab-card .spanish-note {
            font-size: 0.85em;
            color: #ee5a6f;
            font-weight: 600;
            margin-top: 5px;
        }

        .vocab-card.mastered .spanish {
            color: #20bf6b;
        }

        .vocab-card.mastered .spanish-note {
            color: #0fb973;
        }

        .vocab-card .english {
            color: #555;
            font-size: 1.2em;
            display: none;
            font-weight: 600;
        }

        .vocab-card.revealed .english {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .vocab-card .reveal-hint {
            position: absolute;
            top: 12px;
            right: 12px;
            font-size: 1.1em;
            color: #999;
        }

        .vocab-card.mastered .reveal-hint::after {
            content: ' ✅';
            font-size: 1.3em;
        }

        .section-intro {
            background: linear-gradient(135deg, #feca57 0%, #48dbfb 100%);
            padding: 35px;
            border-radius: 20px;
            margin-bottom: 35px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }

        .section-intro h2 {
            font-size: 2.3em;
            margin-bottom: 12px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .section-intro p {
            font-size: 1.1em;
            color: white;
            font-weight: 600;
        }

        .score-display {
            position: fixed;
            top: 25px;
            right: 25px;
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            padding: 18px 30px;
            border-radius: 60px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            font-weight: 700;
            color: white;
            z-index: 1000;
            font-size: 1.1em;
        }

        .quiz-container {
            background: linear-gradient(135deg, #fff9e6 0%, #e6f7ff 100%);
            border-radius: 20px;
            padding: 35px;
            margin: 25px 0;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            border: 4px solid #48dbfb;
        }

        .quiz-question {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 25px;
            font-weight: 700;
        }

        .quiz-input {
            width: 100%;
            padding: 18px;
            border: 4px solid #feca57;
            border-radius: 12px;
            font-size: 1.2em;
            margin: 18px 0;
            font-weight: 600;
        }

        .quiz-input:focus {
            outline: none;
            border-color: #ff6b6b;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.3);
        }

        .quiz-btn {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            border: none;
            padding: 18px 45px;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin: 12px 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .quiz-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(255, 107, 107, 0.4);
        }

        .quiz-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .feedback {
            margin-top: 25px;
            padding: 25px;
            border-radius: 15px;
            font-weight: 700;
            display: none;
            font-size: 1.2em;
        }

        .feedback.correct {
            background: linear-gradient(135deg, #20bf6b 0%, #0fb973 100%);
            color: white;
            border: 4px solid #20bf6b;
            display: block;
        }

        .feedback.incorrect {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            border: 4px solid #ff6b6b;
            display: block;
        }

        .feedback.hint {
            background: linear-gradient(135deg, #feca57 0%, #ff9ff3 100%);
            color: white;
            border: 4px solid #feca57;
            display: block;
        }

        .controls {
            margin: 25px 0;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #48dbfb 0%, #0abde3 100%);
            color: white;
            border: none;
            padding: 14px 35px;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(72, 219, 251, 0.4);
        }

        .btn-reset {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
            border: none;
            padding: 14px 35px;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .btn-reset:hover {
            background: linear-gradient(135deg, #ee5a6f 0%, #c23616 100%);
        }

        .search-box {
            width: 100%;
            padding: 18px;
            border: 4px solid #48dbfb;
            border-radius: 12px;
            font-size: 1.1em;
            margin-bottom: 25px;
            font-weight: 600;
        }

        .progress-bar {
            width: 100%;
            height: 15px;
            background: #f0f0f0;
            border-radius: 10px;
            margin: 25px 0;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #20bf6b 0%, #0fb973 50%, #01a3a4 100%);
            transition: width 0.5s;
            box-shadow: 0 0 10px rgba(32, 191, 107, 0.5);
        }

        .stats-banner {
            background: linear-gradient(135deg, #20bf6b 0%, #01a3a4 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            text-align: center;
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
        }

        .stats-banner h3 {
            font-size: 1.8em;
            margin-bottom: 12px;
        }

        .quiz-results {
            background: linear-gradient(135deg, #fff9e6 0%, #e6f7ff 100%);
            padding: 35px;
            border-radius: 20px;
            margin: 25px 0;
            border: 4px solid #48dbfb;
        }

        .quiz-results h3 {
            font-size: 2em;
            color: #333;
            margin-bottom: 20px;
        }

        .wrong-answer-item {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 12px;
            border-left: 5px solid #ff6b6b;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
        }

        .wrong-answer-item .question {
            font-size: 1.3em;
            font-weight: 700;
            color: #333;
            margin-bottom: 10px;
        }

        .wrong-answer-item .your-answer {
            color: #ff6b6b;
            font-weight: 600;
        }

        .wrong-answer-item .correct-answer {
            color: #20bf6b;
            font-weight: 700;
        }

        .preterite-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .preterite-table th, .preterite-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        .preterite-table th {
            background: #667eea;
            color: white;
            font-weight: 600;
        }

        .preterite-table td {
            background: white;
            color: #333;
            font-size: 1.1em;
        }

        .preterite-table tr:hover td {
            background: #f8f9fa;
        }

        .conjugation-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin: 15px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .conjugation-card h4 {
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        .conjugation-card p {
            font-size: 1.1em;
            line-height: 1.8;
            margin: 10px 0;
        }

        .conjugation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .conjugation-item {
            background: rgba(255,255,255,0.25);
            padding: 15px;
            border-radius: 8px;
            font-size: 1.1em;
            backdrop-filter: blur(10px);
        }

        .conjugation-item strong {
            display: block;
            margin-bottom: 5px;
            font-size: 1.05em;
        }

        @media (max-width: 768px) {
            .vocab-grid {
                grid-template-columns: 1fr;
            }

            header h1 {
                font-size: 2em;
            }

            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="score-display">
        🎯 Mastered: <span id="mastered">0</span> / <span id="total-words">489</span>
    </div>

    <div class="container">
        <header>
            <h1>🌟 Spanish 3 Fun Mastery! 🌟</h1>
            <p style="font-size: 1.3em; font-weight: 600;">Track Your Progress & Ace Those Tryouts! 🚀</p>
        </header>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showSection('all-vocab')">📚 All Vocabulary</button>
            <button class="nav-tab" onclick="showSection('preterite')">⏰ Pretérito</button>
            <button class="nav-tab" onclick="showSection('regular-verbs')">✏️ Regular Verbs</button>
            <button class="nav-tab" onclick="showSection('stem-changing')">🔄 Stem-Changing</button>
            <button class="nav-tab" onclick="showSection('irregular')">⚡ Irregular</button>
            <button class="nav-tab" onclick="showSection('reflexive')">🪞 Reflexive</button>
            <button class="nav-tab" onclick="showSection('body')">👤 Body Parts</button>
            <button class="nav-tab" onclick="showSection('food')">🍕 Food</button>
            <button class="nav-tab" onclick="showSection('clothes')">👕 Clothing</button>
            <button class="nav-tab" onclick="showSection('places')">🏛️ Places</button>
            <button class="nav-tab" onclick="showSection('chores')">🧹 Chores</button>
            <button class="nav-tab" onclick="showSection('sports')">⚽ Sports</button>
            <button class="nav-tab" onclick="showSection('party')">🎉 Party</button>
            <button class="nav-tab" onclick="showSection('expressions')">💬 Expressions</button>
            <button class="nav-tab" onclick="showSection('quiz-mode')">🎮 Quiz Mode</button>
        </div>

        <div class="content">
            <!-- All Vocabulary Section -->
            <div id="all-vocab" class="section active">
                <div class="section-intro">
                    <h2>📚 All Vocabulary - Master Them All!</h2>
                    <p>Click to reveal • Double-click to mark as mastered! Mastered words won't appear in quizzes! ✨</p>
                </div>

                <div class="stats-banner">
                    <h3>📊 Your Amazing Progress!</h3>
                    <p style="font-size: 1.2em;">Mastered: <strong><span id="mastered-count">0</span></strong> words | Quiz Score: <strong><span id="total-quiz-score">0/0</span></strong></p>
                </div>

                <input type="text" class="search-box" id="search-all" placeholder="🔍 Search any word..." onkeyup="searchVocab('all')">

                <div class="progress-bar">
                    <div class="progress-fill" id="progress-all" style="width: 0%"></div>
                </div>

                <div class="controls">
                    <button class="btn-secondary" onclick="revealAll('all')">👁️ Reveal All</button>
                    <button class="btn-secondary" onclick="hideAll('all')">🙈 Hide All</button>
                    <button class="btn-secondary" onclick="shuffleCards('all')">🔀 Shuffle</button>
                    <button class="btn-reset" onclick="resetProgress()">🔄 Reset Progress</button>
                </div>

                <div class="vocab-grid" id="vocab-all"></div>
            </div>

            <!-- Pretérito Section (keeping same structure) -->
            <div id="preterite" class="section">
                <div class="section-intro">
                    <h2>⏰ Pretérito (Preterite) Tense</h2>
                    <p>Master all past tense conjugations!</p>
                </div>

                <div class="conjugation-card">
                    <h4>Regular -AR, -ER, -IR Endings</h4>
                    <table class="preterite-table">
                        <tr>
                            <th>Subject</th>
                            <th>-AR</th>
                            <th>-ER / -IR</th>
                        </tr>
                        <tr>
                            <td><strong>Yo</strong></td>
                            <td>-é</td>
                            <td>-í</td>
                        </tr>
                        <tr>
                            <td><strong>Tú</strong></td>
                            <td>-aste</td>
                            <td>-iste</td>
                        </tr>
                        <tr>
                            <td><strong>Él/Ella/Ud.</strong></td>
                            <td>-ó</td>
                            <td>-ió</td>
                        </tr>
                        <tr>
                            <td><strong>Nosotros</strong></td>
                            <td>-amos</td>
                            <td>-imos</td>
                        </tr>
                        <tr>
                            <td><strong>Vosotros</strong></td>
                            <td>-asteis</td>
                            <td>-isteis</td>
                        </tr>
                        <tr>
                            <td><strong>Ellos/Ellas/Uds.</strong></td>
                            <td>-aron</td>
                            <td>-ieron</td>
                        </tr>
                    </table>
                </div>

                <div class="conjugation-card">
                    <h4>SER & IR (Identical)</h4>
                    <div class="conjugation-grid">
                        <div class="conjugation-item"><strong>Yo:</strong> fui</div>
                        <div class="conjugation-item"><strong>Tú:</strong> fuiste</div>
                        <div class="conjugation-item"><strong>Él/Ella/Ud.:</strong> fue</div>
                        <div class="conjugation-item"><strong>Nosotros:</strong> fuimos</div>
                        <div class="conjugation-item"><strong>Vosotros:</strong> fuisteis</div>
                        <div class="conjugation-item"><strong>Ellos/Uds.:</strong> fueron</div>
                    </div>
                </div>
            </div>

            <!-- Other sections with same structure -->
            <div id="regular-verbs" class="section">
                <div class="section-intro">
                    <h2>✏️ Regular Verbs (89 Total)</h2>
                    <p>Click to reveal • Double-click to master!</p>
                </div>

                <input type="text" class="search-box" id="search-regular" placeholder="🔍 Search verbs..." onkeyup="searchVocab('regular')">

                <div class="controls">
                    <button class="btn-secondary" onclick="revealAll('regular')">👁️ Reveal All</button>
                    <button class="btn-secondary" onclick="hideAll('regular')">🙈 Hide All</button>
                    <button class="btn-secondary" onclick="shuffleCards('regular')">🔀 Shuffle</button>
                </div>

                <div class="vocab-grid" id="vocab-regular"></div>
            </div>

            <div id="stem-changing" class="section">
                <div class="section-intro">
                    <h2>🔄 Stem-Changing Verbs</h2>
                    <p>e→ie, o→ue, e→i changes shown on front!</p>
                </div>

                <input type="text" class="search-box" id="search-stem" placeholder="🔍 Search verbs..." onkeyup="searchVocab('stem')">

                <div class="controls">
                    <button class="btn-secondary" onclick="revealAll('stem')">👁️ Reveal All</button>
                    <button class="btn-secondary" onclick="hideAll('stem')">🙈 Hide All</button>
                </div>

                <div class="vocab-grid" id="vocab-stem"></div>
            </div>

            <div id="irregular" class="section">
                <div class="section-intro">
                    <h2>⚡ Irregular Verbs</h2>
                    <p>Yo forms shown on front!</p>
                </div>

                <input type="text" class="search-box" id="search-irregular" placeholder="🔍 Search verbs..." onkeyup="searchVocab('irregular')">

                <div class="controls">
                    <button class="btn-secondary" onclick="revealAll('irregular')">👁️ Reveal All</button>
                    <button class="btn-secondary" onclick="hideAll('irregular')">🙈 Hide All</button>
                </div>

                <div class="vocab-grid" id="vocab-irregular"></div>
            </div>

            <div id="reflexive" class="section">
                <div class="section-intro">
                    <h2>🪞 Reflexive Verbs</h2>
                    <p>Stem changes shown on front!</p>
                </div>

                <input type="text" class="search-box" id="search-reflexive" placeholder="🔍 Search verbs..." onkeyup="searchVocab('reflexive')">

                <div class="controls">
                    <button class="btn-secondary" onclick="revealAll('reflexive')">👁️ Reveal All</button>
                    <button class="btn-secondary" onclick="hideAll('reflexive')">🙈 Hide All</button>
                </div>

                <div class="vocab-grid" id="vocab-reflexive"></div>
            </div>

            <div id="body" class="section">
                <div class="section-intro">
                    <h2>👤 Body Parts</h2>
                    <p>El cuerpo humano</p>
                </div>

                <input type="text" class="search-box" id="search-body" placeholder="🔍 Search body parts..." onkeyup="searchVocab('body')">

                <div class="controls">
                    <button class="btn-secondary" onclick="revealAll('body')">👁️ Reveal All</button>
                    <button class="btn-secondary" onclick="hideAll('body')">🙈 Hide All</button>
                </div>

                <div class="vocab-grid" id="vocab-body"></div>
            </div>

            <div id="food" class="section">
                <div class="section-intro">
                    <h2>🍕 Food, Drinks & Utensils</h2>
                    <p>Everything delicious!</p>
                </div>

                <input type="text" class="search-box" id="search-food" placeholder="🔍 Search food..." onkeyup="searchVocab('food')">

                <div class="controls">
                    <button class="btn-secondary" onclick="revealAll('food')">👁️ Reveal All</button>
                    <button class="btn-secondary" onclick="hideAll('food')">🙈 Hide All</button>
                </div>

                <div class="vocab-grid" id="vocab-food"></div>
            </div>

            <div id="clothes" class="section">
                <div class="section-intro">
                    <h2>👕 Clothing</h2>
                    <p>La ropa - dress to impress!</p>
                </div>

                <input type="text" class="search-box" id="search-clothes" placeholder="🔍 Search clothing..." onkeyup="searchVocab('clothes')">

                <div class="controls">
                    <button class="btn-secondary" onclick="revealAll('clothes')">👁️ Reveal All</button>
                    <button class="btn-secondary" onclick="hideAll('clothes')">🙈 Hide All</button>
                </div>

                <div class="vocab-grid" id="vocab-clothes"></div>
            </div>

            <div id="places" class="section">
                <div class="section-intro">
                    <h2>🏛️ Places</h2>
                    <p>Lugares around town</p>
                </div>

                <input type="text" class="search-box" id="search-places" placeholder="🔍 Search places..." onkeyup="searchVocab('places')">

                <div class="controls">
                    <button class="btn-secondary" onclick="revealAll('places')">👁️ Reveal All</button>
                    <button class="btn-secondary" onclick="hideAll('places')">🙈 Hide All</button>
                </div>

                <div class="vocab-grid" id="vocab-places"></div>
            </div>

            <div id="chores" class="section">
                <div class="section-intro">
                    <h2>🧹 Household Chores</h2>
                    <p>Quehaceres domésticos</p>
                </div>

                <input type="text" class="search-box" id="search-chores" placeholder="🔍 Search chores..." onkeyup="searchVocab('chores')">

                <div class="controls">
                    <button class="btn-secondary" onclick="revealAll('chores')">👁️ Reveal All</button>
                    <button class="btn-secondary" onclick="hideAll('chores')">🙈 Hide All</button>
                </div>

                <div class="vocab-grid" id="vocab-chores"></div>
            </div>

            <div id="sports" class="section">
                <div class="section-intro">
                    <h2>⚽ Sports & Equipment</h2>
                    <p>Get active with vocab!</p>
                </div>

                <input type="text" class="search-box" id="search-sports" placeholder="🔍 Search sports..." onkeyup="searchVocab('sports')">

                <div class="controls">
                    <button class="btn-secondary" onclick="revealAll('sports')">👁️ Reveal All</button>
                    <button class="btn-secondary" onclick="hideAll('sports')">🙈 Hide All</button>
                </div>

                <div class="vocab-grid" id="vocab-sports"></div>
            </div>

            <div id="party" class="section">
                <div class="section-intro">
                    <h2>🎉 Party Vocabulary</h2>
                    <p>Celebrate in Spanish!</p>
                </div>

                <input type="text" class="search-box" id="search-party" placeholder="🔍 Search party vocab..." onkeyup="searchVocab('party')">

                <div class="controls">
                    <button class="btn-secondary" onclick="revealAll('party')">👁️ Reveal All</button>
                    <button class="btn-secondary" onclick="hideAll('party')">🙈 Hide All</button>
                </div>

                <div class="vocab-grid" id="vocab-party"></div>
            </div>

            <div id="expressions" class="section">
                <div class="section-intro">
                    <h2>💬 Expressions & Phrases</h2>
                    <p>TENER, ESTAR & more!</p>
                </div>

                <input type="text" class="search-box" id="search-expressions" placeholder="🔍 Search expressions..." onkeyup="searchVocab('expressions')">

                <div class="controls">
                    <button class="btn-secondary" onclick="revealAll('expressions')">👁️ Reveal All</button>
                    <button class="btn-secondary" onclick="hideAll('expressions')">🙈 Hide All</button>
                </div>

                <div class="vocab-grid" id="vocab-expressions"></div>
            </div>

            <!-- Enhanced Quiz Mode -->
            <div id="quiz-mode" class="section">
                <div class="section-intro">
                    <h2>🎮 Quiz Mode - Test Your Skills!</h2>
                    <p>Smart hints & feedback! Mastered words are excluded automatically! 🌟</p>
                </div>

                <div id="quiz-active" style="display: block;">
                    <div class="quiz-container">
                        <div class="quiz-question" id="quiz-question">Ready to start? Click "Next Question"! 🚀</div>
                        <input type="text" class="quiz-input" id="quiz-answer" placeholder="Type your answer..." onkeypress="handleEnter(event)">
                        <button class="quiz-btn" id="check-btn" onclick="checkQuizAnswer()" disabled>✅ Check Answer</button>
                        <button class="quiz-btn" id="next-btn" onclick="nextQuestion()" disabled>➡️ Next Question</button>
                        <button class="quiz-btn" style="background: linear-gradient(135deg, #feca57 0%, #ff9ff3 100%);" onclick="finishQuiz()">🏁 Finish Quiz</button>
                        <div id="quiz-feedback" class="feedback"></div>
                    </div>

                    <div class="progress-bar">
                        <div class="progress-fill" id="quiz-progress" style="width: 0%"></div>
                    </div>

                    <p style="text-align: center; font-size: 1.4em; margin-top: 25px; font-weight: 700;">
                        Quiz Progress: <span style="color: #20bf6b;"><span id="quiz-score">0</span></span> / <span id="quiz-total">0</span>
                        <br>
                        <span style="font-size: 0.95em; color: #666;">Accuracy: <span id="quiz-accuracy">0%</span></span>
                    </p>
                </div>

                <!-- Quiz Results Section -->
                <div id="quiz-results" style="display: none;">
                    <div class="quiz-results">
                        <h3>🎉 Quiz Complete!</h3>
                        <p style="font-size: 1.5em; margin: 20px 0;">
                            Final Score: <strong style="color: #20bf6b;"><span id="final-score">0</span>/<span id="final-total">0</span></strong>
                            (<span id="final-accuracy">0</span>%)
                        </p>

                        <div id="wrong-answers-section" style="margin: 30px 0;">
                            <h3 style="color: #ff6b6b; margin-bottom: 20px;">❌ Words to Review (<span id="wrong-count">0</span>)</h3>
                            <div id="wrong-answers-list"></div>
                        </div>

                        <div style="text-align: center; margin-top: 30px;">
                            <button class="quiz-btn" onclick="redoQuiz()">🔄 Redo Entire Quiz</button>
                            <button class="quiz-btn" style="background: linear-gradient(135deg, #feca57 0%, #ff9ff3 100%);" onclick="practiceWrongAnswers()">📝 Practice Wrong Answers</button>
                            <button class="quiz-btn" style="background: linear-gradient(135deg, #48dbfb 0%, #0abde3 100%);" onclick="backToQuiz()">🏠 Start New Quiz</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced vocabulary data with notes for irregular/stem-changing verbs
        const vocabData = {
            regularVerbs: [
                {sp: "ahorrar", en: "to save (money, food, etc)", note: ""},
                {sp: "aplaudir", en: "to applaud", note: ""},
                {sp: "alquilar", en: "to rent", note: ""},
                {sp: "apagar", en: "to turn off (lights, TV, etc)", note: ""},
                {sp: "arreglar", en: "to fix", note: ""},
                {sp: "ayudar", en: "to help", note: ""},
                {sp: "bajar", en: "to go down", note: ""},
                {sp: "besar", en: "to kiss", note: ""},
                {sp: "buscar", en: "to look for", note: ""},
                {sp: "cambiar", en: "to change", note: ""},
                {sp: "caminar", en: "to walk", note: ""},
                {sp: "cantar", en: "to sing", note: ""},
                {sp: "comprar", en: "to buy", note: ""},
                {sp: "contestar", en: "to answer, to reply", note: ""},
                {sp: "cuidar", en: "to take care of", note: ""},
                {sp: "celebrar", en: "to celebrate", note: ""},
                {sp: "cenar", en: "to have dinner", note: ""},
                {sp: "cocinar", en: "to cook", note: ""},
                {sp: "descansar", en: "to rest", note: ""},
                {sp: "desear", en: "to wish", note: ""},
                {sp: "disfrutar", en: "to enjoy", note: ""},
                {sp: "empujar", en: "to push", note: ""},
                {sp: "entregar", en: "to hand in, to give out", note: ""},
                {sp: "escuchar", en: "to listen", note: ""},
                {sp: "esperar", en: "to wait for", note: ""},
                {sp: "esquiar", en: "to ski", note: ""},
                {sp: "estudiar", en: "to study", note: ""},
                {sp: "estacionar", en: "to park (a car, truck, etc)", note: ""},
                {sp: "explicar", en: "to explain", note: ""},
                {sp: "limpiar", en: "to clean", note: ""},
                {sp: "ganar", en: "to earn", note: ""},
                {sp: "gritar", en: "to yell", note: ""},
                {sp: "firmar", en: "to sign", note: ""},
                {sp: "manejar", en: "to drive", note: ""},
                {sp: "hablar", en: "to talk, to speak", note: ""},
                {sp: "mandar", en: "to send", note: ""},
                {sp: "invitar", en: "to invite", note: ""},
                {sp: "mirar", en: "to see, to look", note: ""},
                {sp: "lavar", en: "to wash", note: ""},
                {sp: "necesitar", en: "to need", note: ""},
                {sp: "llamar", en: "to call (someone)", note: ""},
                {sp: "nadar", en: "to swim", note: ""},
                {sp: "llorar", en: "to cry", note: ""},
                {sp: "olvidar", en: "to forget", note: ""},
                {sp: "llegar", en: "to arrive", note: ""},
                {sp: "pagar", en: "to pay", note: ""},
                {sp: "llevar", en: "to carry, to take something/someone", note: ""},
                {sp: "parar", en: "to stop", note: ""},
                {sp: "mascar", en: "to chew", note: ""},
                {sp: "pasar", en: "to pass (by)", note: ""},
                {sp: "patinar", en: "to roller skate", note: ""},
                {sp: "pintar", en: "to color, to paint", note: ""},
                {sp: "preguntar", en: "to ask", note: ""},
                {sp: "practicar", en: "to practice", note: ""},
                {sp: "preparar", en: "to prepare", note: ""},
                {sp: "quemar", en: "to burn", note: ""},
                {sp: "regalar", en: "to give something as a present", note: ""},
                {sp: "regresar", en: "to come back, to return", note: ""},
                {sp: "repasar", en: "to review", note: ""},
                {sp: "tomar", en: "to drink, to take", note: ""},
                {sp: "trabajar", en: "to work", note: ""},
                {sp: "sacar", en: "to take out", note: ""},
                {sp: "saludar", en: "to greet", note: ""},
                {sp: "tocar", en: "to touch, to play an instrument", note: ""},
                {sp: "trotar", en: "to jog", note: ""},
                {sp: "aprender", en: "to learn", note: ""},
                {sp: "beber", en: "to drink", note: ""},
                {sp: "comer", en: "to eat", note: ""},
                {sp: "comprender", en: "to understand", note: ""},
                {sp: "correr", en: "to run", note: ""},
                {sp: "deber", en: "must, should", note: ""},
                {sp: "leer", en: "to read", note: ""},
                {sp: "meter", en: "to put in", note: ""},
                {sp: "prometer", en: "to promise", note: ""},
                {sp: "prender", en: "to turn on", note: ""},
                {sp: "responder", en: "to answer, to reply", note: ""},
                {sp: "romper", en: "to break", note: ""},
                {sp: "vender", en: "to sell", note: ""},
                {sp: "toser", en: "to cough", note: ""},
                {sp: "abrir", en: "to open", note: ""},
                {sp: "asistir", en: "to attend", note: ""},
                {sp: "decidir", en: "to decide", note: ""},
                {sp: "escribir", en: "to write", note: ""},
                {sp: "recibir", en: "to receive", note: ""},
                {sp: "discutir", en: "to argue", note: ""},
                {sp: "interrumpir", en: "to interrupt", note: ""},
                {sp: "subir", en: "to go up", note: ""},
                {sp: "vivir", en: "to live", note: ""}
            ],
            stemChanging: [
                {sp: "cerrar", en: "to close", note: "e→ie"},
                {sp: "cerrar con llave", en: "to lock", note: "e→ie"},
                {sp: "comenzar", en: "to start", note: "e→ie"},
                {sp: "comenzar a", en: "to start doing something", note: "e→ie"},
                {sp: "empezar", en: "to start", note: "e→ie"},
                {sp: "empezar a", en: "to start doing something", note: "e→ie"},
                {sp: "pensar", en: "to think", note: "e→ie"},
                {sp: "entender", en: "to understand", note: "e→ie"},
                {sp: "perder", en: "to lose, to waste time, to miss", note: "e→ie"},
                {sp: "querer", en: "to want", note: "e→ie"},
                {sp: "querer + infinitivo", en: "to want to do something", note: "e→ie"},
                {sp: "querer a", en: "to love someone", note: "e→ie"},
                {sp: "mentir", en: "to lie", note: "e→ie"},
                {sp: "preferir", en: "to prefer", note: "e→ie"},
                {sp: "almorzar", en: "to have lunch", note: "o→ue"},
                {sp: "contar", en: "to count, to tell", note: "o→ue"},
                {sp: "costar", en: "to cost", note: "o→ue"},
                {sp: "encontrar", en: "to find", note: "o→ue"},
                {sp: "jugar", en: "to play", note: "u→ue"},
                {sp: "mostrar", en: "to show", note: "o→ue"},
                {sp: "probar", en: "to taste (food)", note: "o→ue"},
                {sp: "recordar", en: "to remember", note: "o→ue"},
                {sp: "soñar (con)", en: "to dream about", note: "o→ue"},
                {sp: "devolver", en: "to give back", note: "o→ue"},
                {sp: "poder", en: "to be able to, can", note: "o→ue"},
                {sp: "volver", en: "to come back", note: "o→ue"},
                {sp: "dormir", en: "to sleep", note: "o→ue"},
                {sp: "pedir", en: "to ask for", note: "e→i"},
                {sp: "repetir", en: "to repeat", note: "e→i"},
                {sp: "seguir", en: "to follow", note: "e→i"},
                {sp: "seguir + gerundio", en: "to continue doing something", note: "e→i"},
                {sp: "servir", en: "to serve", note: "e→i"},
                {sp: "sonreír", en: "to smile", note: "e→i"},
                {sp: "reír", en: "to laugh", note: "e→i"}
            ],
            irregularVerbs: [
                {sp: "merecer", en: "to deserve", note: "yo: merezco"},
                {sp: "obedecer", en: "to obey", note: "yo: obedezco"},
                {sp: "ofrecer", en: "to offer", note: "yo: ofrezco"},
                {sp: "pertenecer", en: "to belong", note: "yo: pertenezco"},
                {sp: "conducir", en: "to drive", note: "yo: conduzco"},
                {sp: "traducir", en: "to translate", note: "yo: traduzco"},
                {sp: "conocer", en: "to know people/places", note: "yo: conozco"},
                {sp: "dar", en: "to give", note: "yo: doy"},
                {sp: "hacer", en: "to do, to make", note: "yo: hago"},
                {sp: "poner", en: "to put", note: "yo: pongo"},
                {sp: "traer", en: "to bring", note: "yo: traigo"},
                {sp: "salir", en: "to go out", note: "yo: salgo"},
                {sp: "saber", en: "to know facts/information", note: "yo: sé"},
                {sp: "ver", en: "to see", note: "yo: veo"},
                {sp: "decir", en: "to say, to tell", note: "yo: digo"},
                {sp: "venir", en: "to come", note: "yo: vengo"},
                {sp: "ser", en: "to be (permanent)", note: "irregular"},
                {sp: "estar", en: "to be (temporary/location)", note: "irregular"},
                {sp: "ir", en: "to go", note: "irregular"},
                {sp: "tener", en: "to have", note: "irregular"}
            ],
            reflexiveVerbs: [
                {sp: "despertarse", en: "to wake up", note: "e→ie"},
                {sp: "sentarse", en: "to sit down", note: "e→ie"},
                {sp: "acostarse", en: "to go to bed", note: "o→ue"},
                {sp: "dormirse", en: "to fall asleep", note: "o→ue"},
                {sp: "darse prisa", en: "to hurry up", note: ""},
                {sp: "reunirse (con)", en: "to gather, to meet", note: ""},
                {sp: "afeitarse", en: "to shave", note: ""},
                {sp: "bañarse", en: "to shower", note: ""},
                {sp: "burlarse de", en: "to make fun of", note: ""},
                {sp: "darse cuenta de", en: "to realize", note: ""},
                {sp: "cepillarse", en: "to brush", note: ""},
                {sp: "cortarse", en: "to cut (oneself)", note: ""},
                {sp: "equivocarse", en: "to make a mistake", note: ""},
                {sp: "portarse bien", en: "to behave", note: ""},
                {sp: "portarse mal", en: "to misbehave", note: ""},
                {sp: "quejarse (de)", en: "to complain", note: ""},
                {sp: "lavarse", en: "to wash (oneself)", note: ""},
                {sp: "peinarse", en: "to comb", note: ""},
                {sp: "prepararse", en: "to get ready", note: ""},
                {sp: "quitarse", en: "to take off (clothing)", note: ""},
                {sp: "secarse", en: "to dry (oneself)", note: ""},
                {sp: "vestirse", en: "to get dressed", note: "e→i"},
                {sp: "desvestirse", en: "to get undressed", note: "e→i"},
                {sp: "ponerse", en: "to put on", note: ""},
                {sp: "aburrirse", en: "to get bored", note: ""},
                {sp: "alegrarse (de)", en: "to get happy", note: ""},
                {sp: "cansarse (de)", en: "to get tired", note: ""},
                {sp: "divertirse", en: "to have fun", note: "e→ie"},
                {sp: "enfadarse (con)", en: "to get angry", note: ""},
                {sp: "enojarse (con)", en: "to get angry", note: ""},
                {sp: "impacientarse", en: "to get impatient", note: ""},
                {sp: "irritarse", en: "to get irritated", note: ""},
                {sp: "preocuparse", en: "to get worried", note: ""},
                {sp: "sentirse", en: "to feel", note: "e→ie"},
                {sp: "mudarse", en: "to move (housing)", note: ""},
                {sp: "callarse", en: "to be quiet, to shut up", note: ""},
                {sp: "quedarse", en: "to stay", note: ""},
                {sp: "despedirse", en: "to say goodbye", note: "e→i"},
                {sp: "irse", en: "to leave, to go", note: ""},
                {sp: "marcharse", en: "to leave", note: ""}
            ],
            bodyParts: [
                {sp: "brazo", en: "arm", note: ""},
                {sp: "cuerpo", en: "body", note: ""},
                {sp: "oreja", en: "ear", note: ""},
                {sp: "ojo", en: "eye", note: ""},
                {sp: "cara", en: "face", note: ""},
                {sp: "pie/pies", en: "foot/feet", note: ""},
                {sp: "dedo", en: "finger", note: ""},
                {sp: "pelo", en: "hair", note: ""},
                {sp: "mano", en: "hand", note: ""},
                {sp: "cabeza", en: "head", note: ""},
                {sp: "pierna", en: "leg", note: ""},
                {sp: "boca", en: "mouth", note: ""},
                {sp: "cuello", en: "neck", note: ""},
                {sp: "nariz", en: "nose", note: ""},
                {sp: "estómago", en: "stomach", note: ""},
                {sp: "diente/dientes", en: "tooth/teeth", note: ""},
                {sp: "tobillo", en: "ankle", note: ""},
                {sp: "espalda", en: "back", note: ""},
                {sp: "vejiga", en: "bladder", note: ""},
                {sp: "sangre", en: "blood", note: ""},
                {sp: "hueso", en: "bone", note: ""},
                {sp: "corazón", en: "heart", note: ""},
                {sp: "cadera", en: "hip", note: ""},
                {sp: "mandíbula", en: "jaw", note: ""},
                {sp: "riñón", en: "kidney", note: ""},
                {sp: "rodilla", en: "knee", note: ""}
            ],
            food: [
                {sp: "carne", en: "meat", note: ""},
                {sp: "bistec", en: "steak", note: ""},
                {sp: "camarones", en: "shrimp", note: ""},
                {sp: "pan", en: "bread", note: ""},
                {sp: "arroz", en: "rice", note: ""},
                {sp: "frijoles", en: "beans", note: ""},
                {sp: "pollo", en: "chicken", note: ""},
                {sp: "jamón", en: "ham", note: ""},
                {sp: "mariscos", en: "seafood", note: ""},
                {sp: "pescado", en: "fish", note: ""},
                {sp: "tocino", en: "bacon", note: ""},
                {sp: "chorizo", en: "sausage", note: ""},
                {sp: "lentejas", en: "lentils", note: ""},
                {sp: "sopa", en: "soup", note: ""},
                {sp: "mantequilla", en: "butter", note: ""},
                {sp: "mermelada", en: "jelly, marmalade", note: ""},
                {sp: "sal", en: "salt", note: ""},
                {sp: "pimienta", en: "pepper", note: ""},
                {sp: "huevos", en: "eggs", note: ""},
                {sp: "hielo", en: "ice", note: ""},
                {sp: "helado", en: "ice cream", note: ""},
                {sp: "galleta", en: "cookie", note: ""},
                {sp: "panqueque", en: "pancake", note: ""},
                {sp: "fideos", en: "noodles", note: ""},
                {sp: "leche", en: "milk", note: ""},
                {sp: "jugo", en: "juice", note: ""},
                {sp: "naranja", en: "orange", note: ""},
                {sp: "pera", en: "pear", note: ""},
                {sp: "manzana", en: "apple", note: ""},
                {sp: "fresa", en: "strawberry", note: ""},
                {sp: "uva", en: "grape", note: ""},
                {sp: "plátano/banana", en: "banana", note: ""},
                {sp: "arándanos", en: "blueberries", note: ""},
                {sp: "agua", en: "water", note: ""},
                {sp: "café", en: "coffee", note: ""},
                {sp: "gaseosa/soda", en: "soda", note: ""},
                {sp: "limonada", en: "lemonade", note: ""},
                {sp: "té", en: "tea", note: ""},
                {sp: "cuchara", en: "spoon", note: ""},
                {sp: "cuchillo", en: "knife", note: ""},
                {sp: "cucharita", en: "teaspoon", note: ""},
                {sp: "tenedor", en: "fork", note: ""},
                {sp: "vaso", en: "glass", note: ""},
                {sp: "servilleta", en: "napkin", note: ""},
                {sp: "taza", en: "cup", note: ""},
                {sp: "plato", en: "plate", note: ""},
                {sp: "tazón", en: "bowl", note: ""},
                {sp: "espátula", en: "spatula", note: ""},
                {sp: "mantel", en: "tablecloth", note: ""},
                {sp: "pizza", en: "pizza", note: ""},
                {sp: "papitas", en: "chips", note: ""},
                {sp: "pastel", en: "cake", note: ""},
                {sp: "sándwiches", en: "sandwiches", note: ""},
                {sp: "refrescos", en: "drinks", note: ""}
            ],
            clothing: [
                {sp: "abrigo", en: "coat", note: ""},
                {sp: "pantalones", en: "pants", note: ""},
                {sp: "bota(s)", en: "boot(s)", note: ""},
                {sp: "zapatos", en: "shoes", note: ""},
                {sp: "camisa", en: "shirt", note: ""},
                {sp: "falda", en: "skirt", note: ""},
                {sp: "camiseta", en: "t-shirt", note: ""},
                {sp: "corbata", en: "tie", note: ""},
                {sp: "pijama", en: "pajamas", note: ""},
                {sp: "chaleco", en: "vest", note: ""},
                {sp: "traje", en: "suit", note: ""},
                {sp: "vestido", en: "dress", note: ""},
                {sp: "gorro", en: "hat", note: ""},
                {sp: "sombrero", en: "hat", note: ""},
                {sp: "shorts", en: "shorts", note: ""},
                {sp: "ropa de baño", en: "bathing suit", note: ""},
                {sp: "blusa", en: "blouse", note: ""},
                {sp: "medias/calcetines", en: "socks", note: ""},
                {sp: "chaqueta", en: "jacket", note: ""},
                {sp: "bufanda", en: "scarf", note: ""},
                {sp: "guante(s)", en: "glove(s)", note: ""},
                {sp: "sandalia(s)", en: "sandal(s)", note: ""}
            ],
            places: [
                {sp: "librería", en: "bookstore", note: ""},
                {sp: "biblioteca", en: "library", note: ""},
                {sp: "supermercado", en: "supermarket", note: ""},
                {sp: "centro comercial", en: "mall", note: ""},
                {sp: "farmacia", en: "pharmacy", note: ""},
                {sp: "lavandería", en: "laundromat", note: ""},
                {sp: "panadería", en: "bakery", note: ""},
                {sp: "museo", en: "museum", note: ""},
                {sp: "estadio", en: "stadium", note: ""},
                {sp: "discoteca", en: "dancing club", note: ""},
                {sp: "parque", en: "park", note: ""},
                {sp: "peluquería", en: "hair salon", note: ""},
                {sp: "mercado", en: "market", note: ""},
                {sp: "acuario", en: "aquarium", note: ""},
                {sp: "iglesia", en: "church", note: ""},
                {sp: "estacionamiento", en: "parking lot", note: ""},
                {sp: "plaza", en: "plaza", note: ""},
                {sp: "cementerio", en: "cemetery", note: ""},
                {sp: "banco", en: "bank", note: ""},
                {sp: "clínica", en: "clinic", note: ""},
                {sp: "hospital", en: "hospital", note: ""},
                {sp: "estación", en: "station", note: ""},
                {sp: "café", en: "café", note: ""},
                {sp: "cine", en: "movie theater", note: ""},
                {sp: "playa", en: "beach", note: ""}
            ],
            chores: [
                {sp: "pasar la aspiradora", en: "to vacuum", note: ""},
                {sp: "sacar la basura", en: "to take out the trash", note: ""},
                {sp: "lavar los platos", en: "to wash the dishes", note: ""},
                {sp: "fregar los platos", en: "to wash the dishes", note: ""},
                {sp: "lavar la ropa", en: "to wash clothes", note: ""},
                {sp: "doblar la ropa", en: "to fold clothes", note: ""},
                {sp: "planchar", en: "to iron", note: ""},
                {sp: "cortar el césped", en: "to cut the grass", note: ""},
                {sp: "arreglar el dormitorio", en: "to fix the bedroom", note: ""},
                {sp: "hacer la cama", en: "to make the bed", note: ""},
                {sp: "trapear", en: "to mop", note: ""},
                {sp: "sacar a pasear al perro", en: "to walk the dog", note: ""},
                {sp: "dar de comer al perro", en: "to feed the dog", note: ""},
                {sp: "preparar el desayuno", en: "to prepare breakfast", note: ""},
                {sp: "preparar el almuerzo", en: "to prepare lunch", note: ""},
                {sp: "preparar la cena", en: "to prepare dinner", note: ""},
                {sp: "secar la ropa", en: "to dry the clothes", note: ""},
                {sp: "secar los platos", en: "to dry the dishes", note: ""},
                {sp: "regar las plantas", en: "to water the plants", note: ""},
                {sp: "cuidar el jardín", en: "to take care of the garden", note: ""},
                {sp: "lavar el coche", en: "to wash the car", note: ""},
                {sp: "limpiar el baño", en: "to clean the bathroom", note: ""},
                {sp: "limpiar la sala", en: "to clean the living room", note: ""},
                {sp: "quitar la mesa", en: "to clear the table", note: ""},
                {sp: "poner la mesa", en: "to set the table", note: ""},
                {sp: "quitar el polvo", en: "to dust the furniture", note: ""},
                {sp: "sacudir la alfombra", en: "to shake the rug", note: ""},
                {sp: "barrer", en: "to sweep", note: ""}
            ],
            sports: [
                {sp: "básquetbol", en: "basketball", note: ""},
                {sp: "béisbol", en: "baseball", note: ""},
                {sp: "fútbol americano", en: "American football", note: ""},
                {sp: "fútbol", en: "soccer", note: ""},
                {sp: "nadar", en: "to swim", note: ""},
                {sp: "natación", en: "swimming", note: ""},
                {sp: "patinar", en: "to skate", note: ""},
                {sp: "patinar sobre hielo", en: "to ice skate", note: ""},
                {sp: "tenis", en: "tennis", note: ""},
                {sp: "voleibol", en: "volleyball", note: ""},
                {sp: "esgrima", en: "fencing", note: ""},
                {sp: "atletismo", en: "track and field", note: ""},
                {sp: "bate", en: "bat", note: ""},
                {sp: "casco", en: "helmet", note: ""},
                {sp: "guante", en: "glove", note: ""},
                {sp: "patines", en: "skates", note: ""},
                {sp: "pelota", en: "ball", note: ""},
                {sp: "raqueta", en: "racket", note: ""},
                {sp: "partido", en: "match, game", note: ""},
                {sp: "peligroso", en: "dangerous", note: ""},
                {sp: "aficionados", en: "fans", note: ""},
                {sp: "atleta", en: "athlete", note: ""},
                {sp: "campeón", en: "champion", note: ""},
                {sp: "campo", en: "field", note: ""},
                {sp: "cancha", en: "court", note: ""},
                {sp: "equipo", en: "team", note: ""},
                {sp: "estadio", en: "stadium", note: ""},
                {sp: "ganador", en: "winner", note: ""},
                {sp: "jugador", en: "player", note: ""},
                {sp: "piscina", en: "pool", note: ""},
                {sp: "comprender", en: "to understand", note: ""},
                {sp: "reglas", en: "rules", note: ""},
                {sp: "favorito", en: "favorite", note: ""},
                {sp: "ganar", en: "to win", note: ""},
                {sp: "perder", en: "to lose", note: ""}
            ],
            party: [
                {sp: "bailar", en: "to dance", note: ""},
                {sp: "celebrar", en: "to celebrate", note: ""},
                {sp: "cantar", en: "to sing", note: ""},
                {sp: "dar una fiesta", en: "to throw a party", note: ""},
                {sp: "decoraciones", en: "decorations", note: ""},
                {sp: "decorar", en: "to decorate", note: ""},
                {sp: "fiesta sorpresa", en: "surprise party", note: ""},
                {sp: "globo", en: "balloon", note: ""},
                {sp: "invitados", en: "guests", note: ""},
                {sp: "invitación", en: "invitation", note: ""},
                {sp: "invitar a", en: "to invite someone", note: ""},
                {sp: "salir", en: "to go out", note: ""},
                {sp: "secreto", en: "secret", note: ""},
                {sp: "venir", en: "to come", note: ""},
                {sp: "abrir", en: "to open", note: ""},
                {sp: "buscar", en: "to look for", note: ""},
                {sp: "envolver", en: "to wrap", note: "o→ue"},
                {sp: "papel de regalo", en: "wrapping paper", note: ""},
                {sp: "bolsa de regalo", en: "gift bag", note: ""},
                {sp: "recibir", en: "to receive", note: ""},
                {sp: "regalo", en: "gift, present", note: ""},
                {sp: "traer", en: "to bring", note: ""},
                {sp: "dar", en: "to give", note: ""},
                {sp: "decir", en: "to say", note: ""},
                {sp: "poner", en: "to put", note: ""}
            ],
            expressions: [
                {sp: "tener años", en: "to be X years old", note: ""},
                {sp: "tener suerte", en: "to be lucky", note: ""},
                {sp: "tener que", en: "to have to do something", note: ""},
                {sp: "tener ganas de", en: "to feel like doing something", note: ""},
                {sp: "tener calor", en: "to be hot", note: ""},
                {sp: "tener frío", en: "to be cold", note: ""},
                {sp: "tener hambre", en: "to be hungry", note: ""},
                {sp: "tener sed", en: "to be thirsty", note: ""},
                {sp: "tener razón", en: "to be right", note: ""},
                {sp: "tener cuidado", en: "to be careful", note: ""},
                {sp: "tener sueño", en: "to be sleepy", note: ""},
                {sp: "tener celos", en: "to be jealous", note: ""},
                {sp: "tener vergüenza", en: "to be embarrassed, to be ashamed", note: ""},
                {sp: "tener miedo", en: "to be scared", note: ""},
                {sp: "tener la culpa", en: "to be guilty", note: ""},
                {sp: "tener prisa", en: "to be in a hurry", note: ""},
                {sp: "tener éxito", en: "to be successful", note: ""},
                {sp: "tener dolor de", en: "to have pain", note: ""},
                {sp: "estar triste", en: "to be sad", note: ""},
                {sp: "estar cansado", en: "to be tired", note: ""},
                {sp: "estar preocupado", en: "to be worried", note: ""},
                {sp: "estar enfermo", en: "to be sick", note: ""},
                {sp: "estar contento", en: "to be happy", note: ""},
                {sp: "estar enamorado", en: "to be in love", note: ""},
                {sp: "estar furioso", en: "to be furious", note: ""},
                {sp: "estar aburrido", en: "to be bored", note: ""},
                {sp: "estar de buen humor", en: "to be in a good mood", note: ""},
                {sp: "estar de mal humor", en: "to be in a bad mood", note: ""},
                {sp: "estar celoso", en: "to be jealous", note: ""},
                {sp: "estar ocupado", en: "to be busy", note: ""},
                {sp: "estar muerto", en: "to be dead", note: ""},
                {sp: "estar embarazada", en: "to be pregnant", note: ""},
                {sp: "hay", en: "there is, there are", note: ""},
                {sp: "siempre", en: "always", note: ""},
                {sp: "nunca", en: "never", note: ""},
                {sp: "a veces", en: "sometimes", note: ""},
                {sp: "a menudo", en: "often", note: ""},
                {sp: "de vez en cuando", en: "once in a while", note: ""},
                {sp: "todos los días", en: "every day", note: ""},
                {sp: "también", en: "too, as well", note: ""},
                {sp: "después", en: "after, then", note: ""},
                {sp: "luego", en: "then, later", note: ""},
                {sp: "además", en: "furthermore, also, besides", note: ""},
                {sp: "otra vez", en: "again", note: ""},
                {sp: "más", en: "more", note: ""},
                {sp: "pero", en: "but", note: ""},
                {sp: "sin embargo", en: "however", note: ""},
                {sp: "porque", en: "because", note: ""},
                {sp: "por lo tanto", en: "therefore", note: ""},
                {sp: "finalmente", en: "finally", note: ""},
                {sp: "por último", en: "lastly", note: ""}
            ]
        };

        // Combine all vocabulary
        let allVocab = [];
        for (let category in vocabData) {
            allVocab = allVocab.concat(vocabData[category]);
        }

        // Quiz variables
        let quizData = [];
        let currentQuizIndex = 0;
        let quizScore = 0;
        let quizTotal = 0;
        let currentAnswer = '';
        let currentQuestion = null;
        let attemptCount = 0;
        let hasChecked = false;
        let wrongAnswers = [];
        let isPracticingWrongAnswers = false;

        // LocalStorage functions
        function saveProgress() {
            const masteredWords = [];
            document.querySelectorAll('.vocab-card.mastered').forEach(card => {
                masteredWords.push(card.dataset.spanish);
            });

            const progressData = {
                masteredWords: masteredWords,
                quizScore: quizScore,
                quizTotal: quizTotal,
                lastUpdated: new Date().toISOString()
            };

            localStorage.setItem('spanish3Progress', JSON.stringify(progressData));
            updateProgressDisplay();
        }

        function loadProgress() {
            const saved = localStorage.getItem('spanish3Progress');
            if (saved) {
                const progressData = JSON.parse(saved);

                progressData.masteredWords.forEach(spanish => {
                    const card = document.querySelector(`[data-spanish="${spanish}"]`);
                    if (card) {
                        card.classList.add('mastered');
                    }
                });

                quizScore = progressData.quizScore || 0;
                quizTotal = progressData.quizTotal || 0;

                updateProgressDisplay();
            }
        }

        function getMasteredWords() {
            const masteredWords = new Set();
            document.querySelectorAll('.vocab-card.mastered').forEach(card => {
                masteredWords.add(card.dataset.spanish);
            });
            return masteredWords;
        }

        function updateProgressDisplay() {
            const masteredCount = document.querySelectorAll('.vocab-card.mastered').length;
            document.getElementById('mastered').textContent = masteredCount;
            document.getElementById('mastered-count').textContent = masteredCount;
            document.getElementById('total-quiz-score').textContent = quizScore + '/' + quizTotal;

            const progress = (masteredCount / allVocab.length) * 100;
            document.getElementById('progress-all').style.width = progress + '%';
        }

        function resetProgress() {
            if (confirm('Are you sure you want to reset ALL progress? This cannot be undone!')) {
                localStorage.removeItem('spanish3Progress');
                document.querySelectorAll('.vocab-card').forEach(card => {
                    card.classList.remove('mastered');
                });
                quizScore = 0;
                quizTotal = 0;
                wrongAnswers = [];
                updateProgressDisplay();
                alert('Progress reset successfully! ✨');
            }
        }

        // Initialize vocabulary displays
        function initVocab() {
            createVocabCards('all', allVocab);
            createVocabCards('regular', vocabData.regularVerbs);
            createVocabCards('stem', vocabData.stemChanging);
            createVocabCards('irregular', vocabData.irregularVerbs);
            createVocabCards('reflexive', vocabData.reflexiveVerbs);
            createVocabCards('body', vocabData.bodyParts);
            createVocabCards('food', vocabData.food);
            createVocabCards('clothes', vocabData.clothing);
            createVocabCards('places', vocabData.places);
            createVocabCards('chores', vocabData.chores);
            createVocabCards('sports', vocabData.sports);
            createVocabCards('party', vocabData.party);
            createVocabCards('expressions', vocabData.expressions);

            loadProgress();
        }

        function createVocabCards(section, data) {
            const container = document.getElementById('vocab-' + section);
            container.innerHTML = '';

            data.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'vocab-card';
                card.dataset.spanish = item.sp.toLowerCase();
                card.dataset.english = item.en.toLowerCase();

                let spanishDisplay = item.sp;
                let noteDisplay = '';

                // Add note to the front of the card if it exists
                if (item.note && item.note !== '') {
                    noteDisplay = `<div class="spanish-note">(${item.note})</div>`;
                }

                card.innerHTML = `
                    <span class="reveal-hint">👆</span>
                    <div class="spanish">${spanishDisplay}${noteDisplay}</div>
                    <div class="english">${item.en}</div>
                `;

                card.onclick = function() {
                    this.classList.toggle('revealed');
                };

                card.ondblclick = function(e) {
                    e.stopPropagation();
                    this.classList.toggle('mastered');
                    saveProgress();
                };

                container.appendChild(card);
            });
        }

        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
        }

        function revealAll(section) {
            document.querySelectorAll('#vocab-' + section + ' .vocab-card').forEach(card => {
                card.classList.add('revealed');
            });
        }

        function hideAll(section) {
            document.querySelectorAll('#vocab-' + section + ' .vocab-card').forEach(card => {
                card.classList.remove('revealed');
            });
        }

        function shuffleCards(section) {
            const container = document.getElementById('vocab-' + section);
            const cards = Array.from(container.children);
            cards.sort(() => Math.random() - 0.5);
            container.innerHTML = '';
            cards.forEach(card => container.appendChild(card));
        }

        function searchVocab(section) {
            const searchTerm = document.getElementById('search-' + section).value.toLowerCase();
            const cards = document.querySelectorAll('#vocab-' + section + ' .vocab-card');

            cards.forEach(card => {
                const spanish = card.dataset.spanish;
                const english = card.dataset.english;

                if (spanish.includes(searchTerm) || english.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Quiz functions (keeping previous implementation)
        function nextQuestion() {
            if (!isPracticingWrongAnswers) {
                if (quizData.length === 0) {
                    const masteredWords = getMasteredWords();
                    const availableVocab = allVocab.filter(item => !masteredWords.has(item.sp.toLowerCase()));

                    if (availableVocab.length === 0) {
                        alert('Amazing! You\'ve mastered all words! 🎉');
                        return;
                    }

                    quizData = [...availableVocab].sort(() => Math.random() - 0.5);
                }

                if (currentQuizIndex >= quizData.length) {
                    currentQuizIndex = 0;
                    const masteredWords = getMasteredWords();
                    const availableVocab = allVocab.filter(item => !masteredWords.has(item.sp.toLowerCase()));
                    quizData = [...availableVocab].sort(() => Math.random() - 0.5);
                }
            } else {
                if (currentQuizIndex >= quizData.length) {
                    finishQuiz();
                    return;
                }
            }

            currentQuestion = quizData[currentQuizIndex];
            currentAnswer = currentQuestion.en.toLowerCase();
            attemptCount = 0;
            hasChecked = false;

            document.getElementById('quiz-question').textContent = 'Translate: ' + currentQuestion.sp;
            document.getElementById('quiz-answer').value = '';

            const feedback = document.getElementById('quiz-feedback');
            feedback.style.display = 'none';
            feedback.className = 'feedback';

            document.getElementById('next-btn').disabled = true;
            document.getElementById('check-btn').disabled = true;

            currentQuizIndex++;

            const progress = (currentQuizIndex / quizData.length) * 100;
            document.getElementById('quiz-progress').style.width = progress + '%';
        }

        function checkQuizAnswer() {
            const userAnswer = document.getElementById('quiz-answer').value.trim().toLowerCase();
            const feedback = document.getElementById('quiz-feedback');

            attemptCount++;

            const isCorrect = userAnswer === currentAnswer || 
                             (currentAnswer.includes(userAnswer) && userAnswer.length > 3) ||
                             currentAnswer.split(',').some(ans => ans.trim() === userAnswer);

            if (isCorrect) {
                feedback.className = 'feedback correct';
                feedback.innerHTML = '✅ <strong>Correct!</strong> Amazing! 🎉<br>Translation: ' + currentAnswer;
                feedback.style.display = 'block';
                quizScore++;
                quizTotal++;
                document.getElementById('next-btn').disabled = false;
                document.getElementById('check-btn').disabled = true;
                hasChecked = true;
                saveProgress();
            } else if (attemptCount === 1) {
                feedback.className = 'feedback hint';
                const hint = currentAnswer.substring(0, 3) + '...';
                feedback.innerHTML = '💡 <strong>Hint:</strong> Starts with "' + hint + '"<br>Try again!';
                feedback.style.display = 'block';
                document.getElementById('check-btn').disabled = true;
                hasChecked = false;
            } else {
                feedback.className = 'feedback incorrect';
                feedback.innerHTML = '❌ <strong>Incorrect.</strong> Answer: <strong>' + currentAnswer + '</strong><br>Keep practicing!';
                feedback.style.display = 'block';
                quizTotal++;

                wrongAnswers.push({
                    question: currentQuestion.sp,
                    userAnswer: userAnswer,
                    correctAnswer: currentAnswer
                });

                document.getElementById('next-btn').disabled = false;
                document.getElementById('check-btn').disabled = true;
                hasChecked = true;
                saveProgress();
            }

            document.getElementById('quiz-score').textContent = quizScore;
            document.getElementById('quiz-total').textContent = quizTotal;

            const accuracy = quizTotal > 0 ? Math.round((quizScore / quizTotal) * 100) : 0;
            document.getElementById('quiz-accuracy').textContent = accuracy + '%';
        }

        function finishQuiz() {
            document.getElementById('quiz-active').style.display = 'none';
            document.getElementById('quiz-results').style.display = 'block';

            document.getElementById('final-score').textContent = quizScore;
            document.getElementById('final-total').textContent = quizTotal;
            const finalAccuracy = quizTotal > 0 ? Math.round((quizScore / quizTotal) * 100) : 0;
            document.getElementById('final-accuracy').textContent = finalAccuracy;

            document.getElementById('wrong-count').textContent = wrongAnswers.length;

            const wrongList = document.getElementById('wrong-answers-list');
            wrongList.innerHTML = '';

            if (wrongAnswers.length === 0) {
                wrongList.innerHTML = '<p style="text-align: center; font-size: 1.3em; color: #20bf6b;">🎉 Perfect! No wrong answers!</p>';
            } else {
                wrongAnswers.forEach((item, index) => {
                    const div = document.createElement('div');
                    div.className = 'wrong-answer-item';
                    div.innerHTML = `
                        <div class="question"><strong>${index + 1}.</strong> ${item.question}</div>
                        <p><span class="your-answer">Your answer:</span> ${item.userAnswer || '(no answer)'}</p>
                        <p><span class="correct-answer">Correct answer:</span> ${item.correctAnswer}</p>
                    `;
                    wrongList.appendChild(div);
                });
            }
        }

        function redoQuiz() {
            wrongAnswers = [];
            quizScore = 0;
            quizTotal = 0;
            currentQuizIndex = 0;
            quizData = [];
            isPracticingWrongAnswers = false;

            document.getElementById('quiz-results').style.display = 'none';
            document.getElementById('quiz-active').style.display = 'block';

            document.getElementById('quiz-score').textContent = '0';
            document.getElementById('quiz-total').textContent = '0';
            document.getElementById('quiz-accuracy').textContent = '0%';

            nextQuestion();
        }

        function practiceWrongAnswers() {
            if (wrongAnswers.length === 0) {
                alert('No wrong answers to practice! 🎉');
                return;
            }

            isPracticingWrongAnswers = true;
            currentQuizIndex = 0;

            quizData = wrongAnswers.map(item => ({
                sp: item.question,
                en: item.correctAnswer
            })).sort(() => Math.random() - 0.5);

            const tempScore = quizScore;
            const tempTotal = quizTotal;
            wrongAnswers = [];
            quizScore = 0;
            quizTotal = 0;

            document.getElementById('quiz-results').style.display = 'none';
            document.getElementById('quiz-active').style.display = 'block';

            document.getElementById('quiz-score').textContent = '0';
            document.getElementById('quiz-total').textContent = '0';
            document.getElementById('quiz-accuracy').textContent = '0%';

            setTimeout(() => {
                if (isPracticingWrongAnswers) {
                    quizScore += tempScore;
                    quizTotal += tempTotal;
                }
            }, 100);

            nextQuestion();
        }

        function backToQuiz() {
            wrongAnswers = [];
            currentQuizIndex = 0;
            quizData = [];
            isPracticingWrongAnswers = false;

            document.getElementById('quiz-results').style.display = 'none';
            document.getElementById('quiz-active').style.display = 'block';

            nextQuestion();
        }

        function handleEnter(event) {
            if (event.key === 'Enter') {
                const checkBtn = document.getElementById('check-btn');
                const nextBtn = document.getElementById('next-btn');

                if (!checkBtn.disabled) {
                    checkQuizAnswer();
                } else if (!nextBtn.disabled) {
                    nextQuestion();
                }
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const quizInput = document.getElementById('quiz-answer');
            if (quizInput) {
                quizInput.addEventListener('input', function() {
                    const checkBtn = document.getElementById('check-btn');
                    if (this.value.trim().length > 0 && !hasChecked) {
                        checkBtn.disabled = false;
                    } else if (this.value.trim().length === 0) {
                        checkBtn.disabled = true;
                    }
                });
            }
        });

        window.onload = function() {
            initVocab();
            nextQuestion();
        };
    </script>
</body>
</html>
